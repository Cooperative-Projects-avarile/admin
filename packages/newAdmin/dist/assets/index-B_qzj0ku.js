import{i as y,j as e,r as u}from"./index-f5AIFuXe.js";import"./index-BHl4HzdS.js";import{u as A,a as C,b as k,U as w}from"./useFormFields-BDbtDkWD.js";import{S as b,T as M}from"./Table-D3g2WSbA.js";import{M as j}from"./index-DkWIVcay.js";import{F as f,R as S,C as v}from"./index-DB_FTVaT.js";import{B as h}from"./button-CtW_Xfic.js";import{D as O}from"./dropdown-D-S4ftwO.js";import"./EllipsisOutlined-DTrOfCu6.js";import"./index-B_o9MMZ0.js";import"./index-CtIDiRPO.js";const F=["prime","parent","sub"],x=()=>{const{setAddModalShowAct:r,deleteAct:i,queryAct:m,setIsDetailAct:c,dataList:s,formVersion:n}=y("categoryStore");return A(()=>[{title:"name",dataIndex:"name",key:"name",config:{formOptions:{label:"name",name:"name",rules:[{required:!0},{type:"string",min:4,max:60}]}},render(t){return e.jsx("a",{onClick:()=>{c(!0),r({isShowAddModal:!0})},children:t})}},{title:"description",dataIndex:"description",key:"description",config:{isSearch:!0,formOptions:{label:"description",name:"description",rules:[{required:!0},{type:"string",min:4,max:60}]}}},{title:"type",dataIndex:"type",key:"type",config:{isSearch:!0,type:"Select",options:F,formOptions:{initialValue:F[0],label:"type",name:"type",rules:[{required:!0}]}}},{title:"prime_id",dataIndex:"prime_id",key:"prime_id",config:{isSearch:!0,type:"Select",options:()=>s.filter(t=>!t.parent_id).map(t=>({key:t.id,value:t.id,label:t.name})),formOptions:{rules:[{type:"number"}],label:"prime_id",name:"prime_id"},inputAttrConfig:{allowClear:!0}}},{title:"parent_id",dataIndex:"parent_id",key:"parent_id",config:{isSearch:!0,type:"Select",options:t=>{var p;const{formIns:a}=t||{};let o=(p=a==null?void 0:a.getFieldsValue())==null?void 0:p.prime_id;return o?s.filter(l=>l.prime_id===o).map(l=>({key:l.id,value:l.id,label:l.name})):[]},formOptions:{label:"parent_id",name:"parent_id"},inputAttrConfig:{allowClear:!0}}},{title:"action",key:"action",render:(t,a)=>e.jsxs(b,{size:"middle",children:[e.jsx("a",{onClick:()=>{r({isShowAddModal:!0})},children:"edit"}),e.jsx("a",{onClick:()=>{j.confirm({content:"are you sure?",onOk:async()=>{await i({id:a.id}),m()}})},children:"delete"})]})}],[s,n])},V=()=>{const[r]=f.useForm(),{setAddModalShowAct:i,addAct:m,updateAct:c,queryAct:s,refreshFormVersionAct:n,recordData:t,isShowAddModal:a,isDetail:o}=y("categoryStore"),{formList:p}=x(),l=C(p,{formIns:r,isJustShow:o});u.useEffect(()=>{t&&(r.setFieldsValue(t),n())},[t]);let _=o?{footer:[]}:{};const g=u.useRef();return e.jsx(j,{open:a,title:"add",..._,onCancel:()=>{r.resetFields(),i({isShowAddModal:!1})},onOk:()=>{r.validateFields().then(async d=>{await(t?c:m)(d),i({isShowAddModal:!1}),r.resetFields(),s()}).catch(d=>{console.log("Validate Failed:",d)})},children:e.jsx(f,{form:r,onFieldsChange:d=>{d[0].name==="prime_id"&&g.current!==d[0].value&&(g.current=d[0].value,r.setFieldValue("parent_id","")),n()},children:l})})},E=()=>{const{searchList:r}=x(),[i,m]=u.useState(!1);let c=4;const s=k(r,{count:c}),[n]=f.useForm(),{queryAct:t,pageSize:a}=y("categoryStore"),o=p=>{console.log("Received values of form: ",p)};return e.jsxs(f,{form:n,name:"advanced_search",className:"ant-advanced-search-form",onFinish:o,children:[e.jsx(S,{gutter:24,children:i?s:s.slice(0,c)}),e.jsx(S,{children:e.jsxs(v,{span:24,style:{textAlign:"right"},children:[e.jsx(h,{onClick:()=>{t({...n.getFieldsValue(),page:1,page_size:a})},type:"primary",htmlType:"submit",children:"Search"}),e.jsx(h,{style:{margin:"0 8px"},onClick:()=>{n.resetFields()},children:"Clear"}),e.jsxs("a",{style:{fontSize:12},onClick:()=>{m(!i)},children:[i?e.jsx(w,{}):e.jsx(O,{})," Collapse"]})]})})]})},I=()=>e.jsx("div",{style:{marginBottom:"32px"},children:e.jsx(E,{})}),q="_container_18572_1",D={container:q},H=()=>{const{columns:r}=x();return u.useEffect(()=>{},[]),e.jsxs("div",{className:D.content,children:[e.jsx(I,{}),e.jsx(h,{type:"primary",style:{marginBottom:12},children:"+ add"}),e.jsx(V,{}),e.jsx(M,{rowKey:i=>i.id,columns:r})]})};export{H as default};
