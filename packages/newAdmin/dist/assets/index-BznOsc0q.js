import{r as u,M,N as O,j as o,i as B}from"./index-CHx3oPAQ.js";import{F as x,d as U}from"./index-3c9RWdXx.js";import{T as k}from"./treeSelectBase-BL3Z5-02.js";import{B as $}from"./button-BuR4x7gc.js";import{M as q}from"./index-CM0M5W9W.js";import{I as F}from"./index-D-abcRH2.js";import{C as w,T as G,S as J}from"./Table-DTRpGOWg.js";import"./EllipsisOutlined-BpMAEJuO.js";import"./formItemHoc-z0tdCwie.js";import"./dropdown-CLyqTgCB.js";function H(){if(console&&console.warn){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];typeof e[0]=="string"&&(e[0]=`react-i18next:: ${e[0]}`),console.warn(...e)}}const P={};function v(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];typeof e[0]=="string"&&P[e[0]]||(typeof e[0]=="string"&&(P[e[0]]=new Date),H(...e))}const z=(n,e)=>()=>{if(n.isInitialized)e();else{const t=()=>{setTimeout(()=>{n.off("initialized",t)},0),e()};n.on("initialized",t)}};function R(n,e,t){n.loadNamespaces(e,z(n,t))}function _(n,e,t,s){typeof t=="string"&&(t=[t]),t.forEach(i=>{n.options.ns.indexOf(i)<0&&n.options.ns.push(i)}),n.loadLanguages(e,z(n,s))}function K(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=e.languages[0],i=e.options?e.options.fallbackLng:!1,a=e.languages[e.languages.length-1];if(s.toLowerCase()==="cimode")return!0;const l=(b,p)=>{const r=e.services.backendConnector.state[`${b}|${p}`];return r===-1||r===2};return t.bindI18n&&t.bindI18n.indexOf("languageChanging")>-1&&e.services.backendConnector.backend&&e.isLanguageChangingTo&&!l(e.isLanguageChangingTo,n)?!1:!!(e.hasResourceBundle(s,n)||!e.services.backendConnector.backend||e.options.resources&&!e.options.partialBundledLanguages||l(s,n)&&(!i||l(a,n)))}function W(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return!e.languages||!e.languages.length?(v("i18n.languages were undefined or empty",e.languages),!0):e.options.ignoreJSONStructure!==void 0?e.hasLoadedNamespace(n,{lng:t.lng,precheck:(i,a)=>{if(t.bindI18n&&t.bindI18n.indexOf("languageChanging")>-1&&i.services.backendConnector.backend&&i.isLanguageChangingTo&&!a(i.isLanguageChangingTo,n))return!1}}):K(n,e,t)}const Y=u.createContext();class Q{constructor(){this.usedNamespaces={}}addUsedNamespaces(e){e.forEach(t=>{this.usedNamespaces[t]||(this.usedNamespaces[t]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}const X=(n,e)=>{const t=u.useRef();return u.useEffect(()=>{t.current=e?t.current:n},[n,e]),t.current};function A(n,e,t,s){return n.getFixedT(e,t,s)}function Z(n,e,t,s){return u.useCallback(A(n,e,t,s),[n,e,t,s])}function V(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{i18n:t}=e,{i18n:s,defaultNS:i}=u.useContext(Y)||{},a=t||s||O();if(a&&!a.reportNamespaces&&(a.reportNamespaces=new Q),!a){v("You will need to pass in an i18next instance by using initReactI18next");const c=(m,f)=>typeof f=="string"?f:f&&typeof f=="object"&&typeof f.defaultValue=="string"?f.defaultValue:Array.isArray(m)?m[m.length-1]:m,g=[c,{},!1];return g.t=c,g.i18n={},g.ready=!1,g}a.options.react&&a.options.react.wait!==void 0&&v("It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const l={...M(),...a.options.react,...e},{useSuspense:b,keyPrefix:p}=l;let r=n||i||a.options&&a.options.defaultNS;r=typeof r=="string"?[r]:r||["translation"],a.reportNamespaces.addUsedNamespaces&&a.reportNamespaces.addUsedNamespaces(r);const d=(a.isInitialized||a.initializedStoreOnce)&&r.every(c=>W(c,a,l)),N=Z(a,e.lng||null,l.nsMode==="fallback"?r:r[0],p),T=()=>N,I=()=>A(a,e.lng||null,l.nsMode==="fallback"?r:r[0],p),[S,y]=u.useState(T);let j=r.join();e.lng&&(j=`${e.lng}${j}`);const L=X(j),h=u.useRef(!0);u.useEffect(()=>{const{bindI18n:c,bindI18nStore:g}=l;h.current=!0,!d&&!b&&(e.lng?_(a,e.lng,r,()=>{h.current&&y(I)}):R(a,r,()=>{h.current&&y(I)})),d&&L&&L!==j&&h.current&&y(I);function m(){h.current&&y(I)}return c&&a&&a.on(c,m),g&&a&&a.store.on(g,m),()=>{h.current=!1,c&&a&&c.split(" ").forEach(f=>a.off(f,m)),g&&a&&g.split(" ").forEach(f=>a.store.off(f,m))}},[a,j]),u.useEffect(()=>{h.current&&d&&y(T)},[a,p,d]);const C=[S,a,d];if(C.t=S,C.i18n=a,C.ready=d,d||!d&&!b)return C;throw new Promise(c=>{e.lng?_(a,e.lng,r,()=>c()):R(a,r,()=>c())})}const D=({open:n,onCreate:e,onCancel:t})=>{const[s]=x.useForm();return o.jsx(q,{open:n,title:"新建路由",okText:"确定",cancelText:"取消",onCancel:()=>{s.resetFields(),t()},onOk:()=>{s.validateFields().then(i=>{s.resetFields(),e(i)}).catch(i=>{console.log("Validate Failed:",i)})},children:o.jsxs(x,{form:s,layout:"vertical",name:"form_in_modal",initialValues:{modifier:"public"},children:[o.jsx(x.Item,{name:"name",label:"路由名称",rules:[{required:!0,message:"请输入!"}],children:o.jsx(F,{})}),o.jsx(k,{rules:[{required:!0,message:"请输入!"}],name:"path",label:"路径"}),o.jsx(x.Item,{valuePropName:"checked",name:"isNoAuth",label:"不鉴权，客户端强制显示",children:o.jsx(w,{})}),o.jsx(x.Item,{valuePropName:"checked",name:"isOutlet",label:"是否嵌套子路由",children:o.jsx(w,{})}),o.jsx(x.Item,{valuePropName:"checked",name:"index",label:"是否作为Index页面",children:o.jsx(w,{})}),o.jsx(x.Item,{name:"remark",rules:[{required:!0,message:"请输入!"}],label:"备注",children:o.jsx(F,{type:"textarea"})}),o.jsx(k,{rules:[],name:"depands",label:"依赖的权限路由，即某个路由配置了权限，那么该路由就有权限"})]})})},ee=({btnLabel:n,handleUpload:e})=>{const[t,s]=u.useState(!1),i=a=>{e(a),s(!1)};return o.jsxs("span",{style:{marginRight:"12px"},children:[o.jsxs($,{type:"primary",onClick:()=>{s(!0)},children:["+ ",n]}),o.jsx(D,{open:t,onCreate:i,onCancel:()=>{s(!1)}})]})},te="_content_e2ihn_1",ne="_operate_board_e2ihn_1",ae="_upload_e2ihn_5",se="_iconfont_e2ihn_15",E={content:te,operate_board:ne,upload:ae,iconfont:se},oe=[{title:"页面名称",dataIndex:"name",key:"name"},{title:"路径",dataIndex:"path",key:"path"},{title:"可用",dataIndex:"active",key:"active",render:(n,e)=>o.jsx(w,{checked:e.active})},{title:"操作",key:"action",render:()=>o.jsx(J,{size:"middle",children:o.jsx("a",{children:"修改"})})}],he=()=>{const{pageNum:n,pageSize:e,total:t,pageList:s,fetchPageListAct:i,addPageListAct:a}=B("devStore"),{t:l}=V(["dev"]),{loading:b,fn:p}=U.useAsyncFunction(i,{auto:!0,debounceTime:1e3}),r=async()=>{await p()},d=N=>{a(N)};return u.useEffect(()=>{r()},[]),o.jsxs("div",{className:E.content,children:[o.jsx("div",{className:E.operate_board,children:o.jsx(ee,{btnLabel:l`dev.addRouter`,handleUpload:d})}),o.jsx(G,{rowKey:N=>N.id,loading:b,pagination:{pageSize:e,current:n,total:t,onChange(){r()}},columns:oe,dataSource:s||[]})]})};export{he as default};
